<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Plataforma GEST â€” Login e Painel</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css">
<style>
/* CSS ORIGINAL MANTIDO */
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Poppins',sans-serif;background:#f5f7fa;height:100vh;overflow:hidden;display:flex;align-items:center;justify-content:center;}
.login-box{background:white;padding:40px;border-radius:12px;box-shadow:0 0 15px rgba(0,0,0,0.1);width:90%;max-width:380px;text-align:center;}
.login-box h2{margin-bottom:20px;color:#2a3f54;}
.login-box input{width:100%;padding:12px;margin:10px 0;border:1px solid #ccc;border-radius:8px;font-size:16px;}
.login-box button{background:#2a3f54;color:white;border:none;padding:12px 20px;border-radius:8px;font-size:16px;cursor:pointer;width:100%;transition:background 0.3s;}
.login-box button:hover{background:#1a2735;}
.login-box a{color:#2a3f54;text-decoration:none;display:block;margin-top:10px;}
#error-msg{color:red;font-size:14px;display:none;margin-top:10px;}

/* Estilo do Loading do novo login */
.loading{display:none;margin:10px auto;width:30px;height:30px;border:4px solid #ddd;border-top:4px solid #2a3f54;border-radius:50%;animation:spin 1s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}

.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);justify-content:center;align-items:center;z-index:1000;}
.modal-content{background:white;padding:20px;border-radius:12px;width:300px;text-align:center;}
.whatsapp-btn{background:#25D366;color:white;padding:10px 20px;border-radius:8px;text-decoration:none;display:inline-block;}
.whatsapp-btn:hover{background:#1ebe57;}

.dashboard{display:none;width:100%;height:100vh;overflow:hidden;}
.sidebar{width:260px;background:#2a3f54;color:white;display:flex;flex-direction:column;transition:width 0.3s;}
.sidebar.collapsed{width:70px;}
.sidebar .logo{display:flex;align-items:center;gap:10px;padding:15px;background:#1f2e3d;font-weight:600;font-size:18px;}
.sidebar .logo img{width:30px;height:30px;}
.sidebar ul{list-style:none;flex-grow:1;}
.sidebar ul li{padding:14px 20px;display:flex;align-items:center;gap:14px;cursor:pointer;transition:background 0.2s;}
.sidebar ul li:hover,.sidebar ul li.active{background:#1a2735;}
.sidebar ul li i{font-size:20px;min-width:24px;}
.sidebar ul li span{white-space:nowrap;}
.sidebar.collapsed ul li span{display:none;}

.header{position:fixed;top:0;left:260px;right:0;height:60px;background:white;box-shadow:0 1px 5px rgba(0,0,0,0.1);display:flex;align-items:center;justify-content:space-between;padding:0 20px;transition:left 0.3s;z-index:10;}
.sidebar.collapsed + .main .header{left:70px;}
.header h1{font-size:18px;color:#2a3f54;}
.toggle-btn{cursor:pointer;font-size:22px;color:#2a3f54;}
.logout-btn{background:#2a3f54;color:white;padding:8px 14px;border-radius:6px;border:none;cursor:pointer;}

.main{flex-grow:1;display:flex;flex-direction:column;}
.content{margin-top:60px;height:calc(100vh - 60px);overflow:auto;background:#f5f7fa;padding:20px;}
iframe{width:100%;height:80vh;border:none;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);}

.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:20px;}
.card{background:white;border-radius:12px;padding:20px;box-shadow:0 2px 10px rgba(0,0,0,0.1);text-align:center;cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;}
.card:hover{transform:translateY(-4px);box-shadow:0 4px 14px rgba(0,0,0,0.15);}
.card i{font-size:38px;color:#2a3f54;margin-bottom:10px;}
.card h3{margin-bottom:5px;}
.card p{font-size:14px;color:#666;}

@media (max-width:768){
  .sidebar{position:fixed;height:100%;z-index:20;transform:translateX(-100%);}
  .sidebar.show{transform:translateX(0);}
  .header{left:0 !important;}
}
</style>
</head>
<body>

<div class="login-box" id="login-screen">
  <img src="https://i.ibb.co/JW5wgT3s/plataformagest.png" alt="plataformagest" width="220">
  <h2>Plataforma GEST</h2>
  <input type="text" id="usuario" placeholder="UsuÃ¡rio">
  <input type="password" id="senha" placeholder="Senha de acesso">
  <button onclick="login()">Entrar</button>
  <div class="loading" id="loading"></div>
  <p id="error-msg">UsuÃ¡rio ou senha invÃ¡lidos.</p>
  <a href="#" onclick="abrirPix()">Criar conta (Pix)</a>
</div>

<div id="pixModal" class="modal">
  <div class="modal-content">
    <h3>Pagamento via Pix</h3>
    <input type="text" id="nome_pix" placeholder="Nome completo" style="width:100%;padding:8px;margin:5px 0;border-radius:5px;border:1px solid #ccc;">
    <input type="text" id="cpf_pix" placeholder="CPF" style="width:100%;padding:8px;margin:5px 0;border-radius:5px;border:1px solid #ccc;">
    <p style="margin-top:10px;">ðŸ’° Valor: <strong>R$25,00/mÃªs</strong></p>
    <p>ðŸ“Ž Chave Pix (CPF): <strong>96702656220</strong></p>
    <button onclick="mostrarWhats()" style="background:#25D366;color:white;border:none;padding:10px;width:100%;border-radius:8px;cursor:pointer;margin-top:10px;">JÃ¡ paguei</button>
    <div id="senhaBox" style="display:none;margin-top:10px;">
        <a id="whatsLink" target="_blank" class="whatsapp-btn">ðŸ“² Enviar comprovante</a>
    </div>
    <button onclick="fecharPix()" style="margin-top:10px;background:none;border:none;color:#666;cursor:pointer;">Fechar</button>
  </div>
</div>

<div class="dashboard" id="dashboard">
  <div class="sidebar" id="sidebar">
    <div class="logo">
        <img src="https://cdn-icons-png.flaticon.com/512/2098/2098298.png" alt="Logo">
        <span>Plataforma GEST</span>
    </div>
    <ul>
      <li class="active" data-page="inicio"><i class="ri-home-5-line"></i><span>InÃ­cio</span></li>
      <li data-page="planejamento"><i class="ri-calendar-check-line"></i><span>Planejamento</span></li>
      <li data-page="autoria"><i class="ri-pencil-ruler-2-line"></i><span>Autoria</span></li>
      <li data-page="gestao"><i class="ri-briefcase-4-line"></i><span>GestÃ£o de Sala</span></li>
      <li onclick="abrirLink('https://chat.whatsapp.com/INWzt9qAmzyDg2JnJkwPcu')">
        <i class="ri-whatsapp-line" style="color:#25D366;"></i><span>Grupo WhatsApp</span>
      </li>
      <li onclick="abrirLink('https://www.youtube.com/@educava4279')">
        <i class="ri-youtube-line" style="color:#ff0000;"></i><span>YouTube Educava</span>
      </li>
    </ul>
  </div>

  <div class="main">
    <div class="header">
      <span class="toggle-btn" id="toggleBtn"><i class="ri-menu-line"></i></span>
      <h1>Ferramentas Docentes</h1>
      <button class="logout-btn" onclick="logout()">Sair</button>
    </div>
    <div class="content" id="content">
        </div>
  </div>
</div>

<script>
/* ========= LÃ“GICA DE LOGIN GOOGLE SHEETS ========= */
const API_URL = "https://script.google.com/macros/s/AKfycbxu2eoqw38Cws30P7QPNy8_Y4uELofkeIkSv98b8FrLDBBC5FL1inyEHKB-aYs8Y9FSpA/exec";

function login() {
    const userVal = document.getElementById("usuario").value;
    const passVal = document.getElementById("senha").value;
    
    error(false); 
    loading(true);

    fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
            usuario: userVal,
            senha: passVal
        })
    })
    .then(r => r.json())
    .then(r => {
        if(r.status === "ok") {
            localStorage.setItem("gest_logado", "1");
            showDashboard();
        } else {
            error(true);
        }
    })
    .catch(() => error(true))
    .finally(() => loading(false));
}

function loading(v) { document.getElementById("loading").style.display = v ? "block" : "none"; }
function error(v) { document.getElementById("error-msg").style.display = v ? "block" : "none"; }

function showDashboard() {
    document.getElementById('login-screen').style.display = 'none';
    document.getElementById('dashboard').style.display = 'flex';
    pages.inicio(); // Carrega a pÃ¡gina inicial ao entrar
}

function logout() {
    localStorage.removeItem("gest_logado");
    location.reload();
}

/* ========= AUTO LOGIN ========= */
if(localStorage.getItem("gest_logado") === "1"){
    showDashboard();
}

/* ========= LÃ“GICA DO PAINEL (MANTIDA) ========= */
function abrirPix() { document.getElementById('pixModal').style.display = 'flex'; }
function fecharPix() { document.getElementById('pixModal').style.display = 'none'; }

function mostrarWhats() {
    const nome = document.getElementById('nome_pix').value;
    const cpf = document.getElementById('cpf_pix').value;
    const msg = encodeURIComponent(`OlÃ¡! Sou ${nome} (CPF ${cpf}). JÃ¡ paguei o Pix da Plataforma GEST.`);
    document.getElementById('whatsLink').href = `https://wa.me/5569981120161?text=${msg}`;
    document.getElementById('senhaBox').style.display = "block";
}

function abrirLink(url) { window.open(url, '_blank'); }

const sidebar = document.getElementById("sidebar"),
      toggleBtn = document.getElementById("toggleBtn"),
      content = document.getElementById("content"),
      items = document.querySelectorAll(".sidebar ul li");

toggleBtn.onclick = () => {
    if(window.innerWidth <= 768) { sidebar.classList.toggle("show"); } 
    else { sidebar.classList.toggle("collapsed"); }
};

function showCards(cards) {
    const cardsHTML = `<div class="cards">${cards.map(c =>
        `<div class="card" onclick="openIframe('${c.link}','${c.titulo}')">
            <i class='${c.icone}'></i><h3>${c.titulo}</h3><p>${c.desc}</p>
        </div>`).join('')}
    </div>`;
    content.innerHTML = cardsHTML;
}

function openIframe(link, titulo) {
    if(link.startsWith("external:")) {
        window.open(link.replace("external:", ""), "_blank");
        return;
    }
    content.innerHTML = `
        <button class="logout-btn" style="margin-bottom:15px;" onclick="pages.inicio()">â¬… Voltar</button>
        <h2>${titulo}</h2>
        <iframe src='${link}'></iframe>
    `;
}

const pages = {
    inicio: () => {
        content.innerHTML = `
        <div style="max-width:900px;margin:auto;text-align:center;">
            <h2 style="color:#2a3f54;margin-bottom:20px;">Bem-vindo Ã  Plataforma GEST</h2>
            <div style="position:relative;padding-top:56.25%;border-radius:12px;overflow:hidden;box-shadow:0 4px 14px rgba(0,0,0,0.15);background:#000;">
                <iframe src="https://drive.google.com/file/d/1j0_iisDxya3ryH3mQmzHuTmdVwy9GKJO/preview" style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;" allowfullscreen></iframe>
            </div>
            <p style="margin-top:15px;color:#555;font-size:14px;">Assista ao vÃ­deo de apresentaÃ§Ã£o para conhecer todos os recursos.</p>
        </div>`;
    },
    planejamento: () => showCards([
        {titulo:"Planejador Semanal", desc:"Organize suas aulas pela BNCC.", icone:"ri-calendar-check-line", link:"https://profkleidivaldo.github.io/planejadorsemanal/"},
        {titulo:"Planejador Form", desc:"Crie planejamentos via formulÃ¡rio.", icone:"ri-file-edit-line", link:"external:https://sites.google.com/view/planejaontestegratis/planejamentos"},
        {titulo:"Arquivo Planejamentos", desc:"Salve seus planejamentos aqui", icone:"ri-folder-open-line", link:"external:https://drive.google.com/drive/folders/1w722ikZDF2h8Bw9Q3VpQXJ9jj81pUXsg"}
    ]),
    autoria: () => showCards([
        {titulo:"Construtor de Aulas", desc:"Monte pÃ¡ginas com textos e vÃ­deos.", icone:"ri-book-open-line", link:"https://profkleidivaldo.github.io/construtor/"},
        {titulo:"Criador de QuestionÃ¡rios", desc:"Quizzes automÃ¡ticos.", icone:"ri-question-answer-line", link:"https://profkleidivaldo.github.io/geradorquestionarios/"},
        {titulo:"Construtor de AvaliaÃ§Ãµes", desc:"Monte provas personalizadas.", icone:"ri-file-list-3-line", link:"https://profkleidivaldo.github.io/construtoravaliacoes/"},
        {titulo:"Construtor de Quizes", desc:"Monte quizes personalizados.", icone:"ri-game-line", link:"https://profkleidivaldo.github.io/criadordequiz/"},
        {titulo:"Mural Digital", desc:"Crie murais colaborativos.", icone:"ri-layout-grid-line", link:"https://profkleidivaldo.github.io/mural/"}
    ]),
    gestao: () => showCards([
        {titulo:"DiÃ¡rio de Aula", desc:"Registre conteÃºdos.", icone:"ri-book-open-line", link:"https://profkleidivaldo.github.io/diario/"},
        {titulo:"Chamada e FrequÃªncia", desc:"Controle frequÃªncia.", icone:"ri-contacts-book-2-line", link:"https://profkleidivaldo.github.io/chamada/"},
        {titulo:"Espelho de notas 2Â°ANO",desc:"LanÃ§e as notas aqui",icone:"ri-file-edit-line",link:"external:https://docs.google.com/spreadsheets/d/1A2SEdy6W4-cZfO0AIOtgso5LFMLITdiRFivyGr4JwuE/edit?gid=1000158642#gid=1000158642"},
    {titulo:"Espelho de notas 3Â°ANO",desc:"LanÃ§e as notas aqui",icone:"ri-file-edit-line",link:"external:https://docs.google.com/spreadsheets/d/1Ok3L284rzj3Iwf6Q2z2YAn9qa8Xa_pkI8Fzr5LJP0L0/edit?usp=sharing"},
    {titulo:"Espelho de notas 4Â°ANO",desc:"LanÃ§e as notas aqui",icone:"ri-file-edit-line",link:"external:https://docs.google.com/spreadsheets/d/18L83bD2h5J0cuATSnI2YcCMXc86Jm0W-ZdmzzfFkFu0/edit?usp=sharing"},
    {titulo:"Espelho de notas 5Â°ANO",desc:"LanÃ§e as notas aqui",icone:"ri-file-edit-line",link:"external:https://docs.google.com/spreadsheets/d/10CNByUcNnAOMq8-hutTxR6u_tX9D0rQYOsFTUKpyyyM/edit?usp=sharing"},
        {titulo:"Medidor de FluÃªncia", desc:"Avalie fluÃªncia leitora.", icone:"ri-sound-module-line", link:"https://profkleidivaldo.github.io/medidorfluencia/"}
    ])
};

items.forEach(li => {
    li.addEventListener('click', () => {
        const page = li.getAttribute('data-page');
        if(page) {
            document.querySelector('.sidebar ul li.active')?.classList.remove('active');
            li.classList.add('active');
            pages[page]();
            if(window.innerWidth <= 768) sidebar.classList.remove('show');
        }
    });
});
</script>
</body>
</html>
